# App 界面设计方案（智慧社区 IoT Android）

本文档为 Smarthome Android 客户端的界面设计方案。设计遵循你在文档目录中的系统架构与接口规范；如未提供品牌或字体规范，采用主流 Material Design 3（MD3）最佳实践并保留品牌替换位。

—— 版本：v1.0（首次提交）  |  存放位置：c:\Users\Administrator\AndroidStudioProjects\Smarthome\文档\界面设计方案.md

## 1. 设计目标与原则
- 全链路 IoT：面向“设备管理、传感数据、安防事件、场景联动”的高频操作与监控。
- 响应式与可适配：适配不同分辨率与屏幕密度（手机为主，平板次要）。
- 一致性与清晰性：视觉元素统一、操作路径明确、状态反馈充分。
- 安全与可靠：关键操作（设备控制/安防处理）具备确认与记录，网络断开有离线提示。

## 2. 整体布局
- 布局风格：MD3 风格卡片 + 底部导航 + 顶部 AppBar（搜索/筛选/动作入口）。
- 响应式适配：
  - 手机（窄屏）：单列主内容，卡片列表为主；详情采用 BottomSheet/全屏。
  - 平板（中/宽屏）：两栏布局（导航/列表 + 详情），提升并行浏览效率。
- 主色调：使用“品牌色系”占位，后续替换为你文档中定义的品牌色；如未明确，则使用建议方案：
  - Primary（BRAND_PRIMARY，占位，默认示例：#2E7D32 绿色）
  - Secondary（BRAND_SECONDARY，占位，默认示例：#1565C0 蓝色）
  - Background：#FAFAFA（浅灰）/ #121212（暗黑）
  - Surface：#FFFFFF（浅色）/ #1E1E1E（暗黑）
  - Error：#D32F2F（红色）
- 字体规范：
  - 中文：系统默认中文字体（MIUI/EMUI/ColorOS 下遵循系统），字重 Regular/Medium。
  - 西文：Roboto（Android 默认），字号与行高遵循 MD3 排版。
  - 层级：
    - 标题（H1/H2/H3）：24sp/22sp/20sp
    - 正文：16sp（行高 1.4）
    - 辅助说明/标签：12–14sp
- 暗色模式：全局支持；保证对比度与可读性，图表采用暗色配色方案。

## 3. 视觉规范
- 图标风格：线性图标（Outlined/Stroke），统一轮廓与笔画粗细。
- 间距标准：8dp 基准单位（4/8/12/16/24/32dp）网格体系。
- 阴影效果：轻微投影（Elevation 1–3）体现层级；重要浮层 Elevation 8–16。
- 卡片/按钮圆角：8–12dp（移动端常用），与品牌气质协调。
- 图片与矢量：全部使用 SVG（VectorDrawable）格式；禁止位图作为图标。

## 4. 核心页面结构

### 4.1 底部导航（固定式导航）
- Tab：主页 | 功能 | 个人中心
- 规则：最多 3 个一级入口，保证聚焦；子功能通过二级列表或顶部筛选入口进入。

### 4.2 首页（仪表盘）
- 目标：快速总览与常用操作入口。
- 信息模块：
  - 设备总览卡片：在线设备数、异常设备数、待处理事件数。
  - 传感快照卡片：温湿度最近值与趋势箭头、光照/气体/PM2.5 等摘要。
  - 安防事件卡片：最近 3 条事件（时间、设备、位置、状态），一键进入详情。
  - 网络状态条：REST/MQTT 连接状态（已连接/重试中/断开），点击查看诊断。
- 快捷入口：常用场景（如“回家模式”“节能模式”）、设备群控（如“全部关闭灯光”）。
- 交互：下拉刷新、加载骨架屏、错误重试按钮。

### 4.3 功能页（操作与数据）
- 功能分区：以卡片分组方式展示设备控制、传感数据、场景联动等：
  - 设备控制：设备列表（图标、名称、位置、在线状态），进入设备详情。
    - 设备详情：
      - 状态信息：在线/离线、信号强度、电源/继电器状态、最近更新时间。
      - 控制面板：继电器切换、电机启停、阈值设置；操作前二次确认（关键动作）。
      - 实时数据：通过 MQTT 推送实时更新（闪烁/徽标提示）。
      - 历史曲线：温湿度/光照等折线图，支持时间范围选择。
  - 传感数据：
    - 列表筛选：按设备/类型/时间段筛选；空态提示与重试按钮。
    - 图表组件：折线/柱状组合，平均/最大/最小标记，工具提示。
  - 场景联动：
    - 条件/动作配置：如“温度>30℃ -> 打开风扇”；启用/停用切换。
    - 执行日志：最近触发记录与结果。
- 辅助功能：搜索、筛选抽屉、批量操作、长按多选、标签过滤。

### 4.4 个人中心（用户信息与设置）
- 用户信息：头像、昵称、手机号；编辑保存。
- 安全设置：
  - Token 与登录状态显示；手动刷新；自动刷新提示（仅展示不操作）。
  - 密码修改入口（如后端支持）。
- 系统设置：
  - 服务器配置：API Base URL、MQTT URI、心跳/超时；“测试连接”按钮。
  - 日志与诊断：
    - 网络诊断页：REST/MQTT 连通性测试、延迟、重试次数、最近错误。
    - 导出日志（仅文本）、清理缓存。
- 关于与反馈：版本信息、开源许可、问题反馈入口。
- 退出登录：二次确认。

## 5. 交互元素与状态管理
- 按钮样式：圆角、主按钮填充（Primary）、次按钮描边（Secondary）；禁用态降低透明度。
- 导航栏：底部固定式，图标+文本；当前页高亮（主色/指示条）。
- 加载状态：统一使用骨架屏（Skeleton）与进度指示器（Circular/Linear）；列表首次加载使用骨架，拉取更多使用底部 Loading。
- 反馈机制：SnackBar（成功/警告/错误），轻提示用 Toast，关键操作用对话框确认。
- 空态与错误：
  - 空列表：展示占位插画+引导文案+“添加设备/刷新”按钮。
  - 网络错误：错误文案+“重试”按钮；离线提示在状态条显示并允许进入诊断页。
- 实时性与一致性：MQTT 推送与 REST 定时拉取（传感数据页支持自动刷新开关）。

## 6. 可用性与无障碍（A11y）
- 触控目标：最小 48dp。
- 对比度：文字与背景对比度符合 WCAG AA；暗色模式优化。
- 文本缩放：尊重系统字体缩放，不破坏布局。
- 语义标签：关键控件添加 contentDescription，图表提供数据摘要。

## 7. 资源与命名规范（与 Android 端实现对齐）
- 颜色：`res/values/colors.xml` 中以设计 Token 命名：
  - colorPrimary、colorOnPrimary、colorSecondary、colorOnSecondary、colorSurface、colorOnSurface、colorError、colorOnError。
- 字体与样式：`res/values/styles.xml` / `theme.xml` 中定义 TextAppearance 与 ShapeAppearance；遵循 MD3 命名。
- 图标：`res/drawable/` 下使用 VectorDrawable（SVG 转换），命名规则如 `ic_device_light_outlined.xml`。
- 间距维度：`res/values/dimens.xml` 中定义 `space_4dp/8dp/12dp/...`。
- 布局：`res/layout/` 采用 `page_*`（页面）、`item_*`（列表项）、`dialog_*`（弹窗）命名。

## 8. 导航与路由
- 一级导航：BottomNavigation（三个 Tab：home、features、profile）。
- 二级导航：
  - 设备详情使用 Activity/Fragment；从设备列表进入。
  - 诊断页、设置页为独立 Activity/Fragment，从个人中心进入。
- 返回行为：遵循 Android 系统返回栈；关键未保存状态弹框确认。

## 9. 数据与实时性联动（接口对齐）
- 首页摘要：
  - REST：`GET v1/devices`、`GET v1/security/events` 获取摘要。
  - MQTT：订阅 `smart_community/devices/+/status`、`smart_community/sensors/+/data`。
- 设备详情：
  - REST：`GET v1/devices/{deviceId}`、`GET v1/devices/{deviceId}/status`。
  - 控制：`POST v1/devices/{deviceId}/command`；MQTT 发布 `smart_community/devices/{deviceId}/control`（双轨）。
- 传感数据页：
  - REST：`GET v1/sensors/data`（筛选分页）；MQTT 实时数据用于最新读数刷新。
- 安防事件页：
  - REST：`GET v1/security/events` / `GET v1/security/events/{eventId}` / `PUT v1/security/events/{eventId}/process`。

## 10. 辅助体验（动画与动效）
- 页面切换：淡入/位移 100–150ms，避免过度动画。
- 列表更新：新增项轻微高亮 1.5s；实时数据卡片数值变化闪烁 300ms。
- 下拉刷新：水滴进度指示与回弹动画。

## 11. 典型页面模块草图（文字描述）
- 首页：顶部 AppBar（标题+诊断入口） -> 统计卡片（3 列于手机为单列滚动） -> 快捷操作 -> 最近事件列表。
- 功能页：分组卡片（设备控制/传感数据/场景），卡片包含标题、描述、操作按钮，点击进入详情。
- 设备详情：顶部设备信息 -> 控制面板（开关/滑块/按钮） -> 实时读数（徽标） -> 历史图表（时间范围选择）。
- 个人中心：用户信息 -> 安全设置 -> 系统设置（服务器配置与连接测试） -> 日志诊断 -> 关于/反馈 -> 退出登录。

## 12. 安全与关键操作提示
- 设备控制关键动作（如电机启停）使用二次确认弹窗；记录操作时间与操作者。
- 服务端异常时提供“离线模式”指示，允许浏览本地缓存但禁用控制。

## 13. 后续交付
- 若后续提供品牌色与字体规范文档：替换第 2 节色彩与第 3 节字体占位为正式规范。
- 可输出线框图与原型（Figma/手绘导出为 SVG），并建立组件库清单以对接开发实现。

—— 完 ——